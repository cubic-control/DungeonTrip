package com.fuller.DungeonTrip.entities;

import org.joml.Vector3f;
import org.lwjgl.glfw.GLFW;

import com.fuller.DungeonTrip.Refs;
import com.fuller.DungeonTrip.Window;
import com.fuller.DungeonTrip.render.Camera;
import com.fuller.DungeonTrip.render.Model;
import com.fuller.DungeonTrip.render.Shader;
import com.fuller.DungeonTrip.render.Texture;
import com.fuller.DungeonTrip.world.World;

public class EntityPlayer {
	private Model model;
	private Texture texture;
	private Transform transform;
	
	static float speed = 0.5f;
	
	public EntityPlayer()
	{
		float[] vertices = new float[] {
				-1f, 1f, 0,
				1f, 1f, 0,
				1f, -1f, 0,
				-1f, -1f, 0
		};
		float[] texture = new float[] {
				0, 0,
				1, 0,
				1, 1,
				0, 1
		};
		int[] indices = new int[] {
				0, 1, 2,
				2, 3, 0
		};
		
		model = new Model(vertices, texture, indices);
		this.texture = new Texture("test2");
		
		transform = new Transform();
		transform.scale = new Vector3f(16, 16, 1);
	}
	
	public void update(float delta, Window window, Camera camera, World world)
	{
		if(Refs.window.getInput().isKeyDown(GLFW.GLFW_KEY_A))
		{
			transform.pos.add(new Vector3f(-speed, 0, 0));
		}
		if(Refs.window.getInput().isKeyDown(GLFW.GLFW_KEY_D))
		{
			transform.pos.add(new Vector3f(speed, 0, 0));
		}
		if(Refs.window.getInput().isKeyDown(GLFW.GLFW_KEY_W))
		{
			transform.pos.add(new Vector3f(0, speed, 0));
		}
		if(Refs.window.getInput().isKeyDown(GLFW.GLFW_KEY_S))
		{
			transform.pos.add(new Vector3f(0, -speed, 0));
		}
		camera.setPosition(transform.pos.mul(-world.getScale(), new Vector3f()));
	}
	
	public void render(Shader shader, Camera camera)
	{
		shader.bind();
		shader.setUniform("sampler", 0);
		shader.setUniform("projection", transform.getProjection(camera.getProjection()));
		texture.bind(0);
		model.render();
	}

}
